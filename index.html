import React, { useState } from 'react';
import { ChevronRight, ChevronLeft, CheckCircle, XCircle, AlertCircle, MapPin, AlertTriangle } from 'lucide-react';

const WorkflowTool = () => {
  const [currentStep, setCurrentStep] = useState(0);
  const [answers, setAnswers] = useState({});
  const [result, setResult] = useState(null);
  const [viewMode, setViewMode] = useState('detailed');
  const [editMode, setEditMode] = useState(false);

  const universalQuestions = [
    {
      id: 'copd_diagnosis',
      question: 'Does the patient have COPD (Chronic Obstructive Pulmonary Disease)?',
      type: 'yesno',
      required: true
    },
    {
      id: 'abg_done',
      question: 'Has the patient had an arterial blood gas (ABG) test?',
      type: 'yesno',
      required: true,
      help: 'Venous blood gas, pulse oximetry, or other methods do not qualify'
    },
    {
      id: 'co2_value',
      question: 'What was the patient\'s CO2 level (PaCO2) on the ABG test?',
      type: 'number',
      required: true,
      help: 'Enter the PaCO2 value in mmHg (must be ≥52 mmHg to qualify)',
      unit: 'mmHg'
    },
    {
      id: 'patient_awake',
      question: 'Was the patient awake during the ABG test?',
      type: 'yesno',
      required: true
    },
    {
      id: 'oxygen_requirement',
      question: 'What is the patient\'s current oxygen requirement?',
      type: 'radio',
      required: true,
      options: [
        { value: 'room_air', label: 'Room air (no supplemental oxygen)' },
        { value: 'low_oxygen', label: 'Low oxygen (<36% or <4L nasal)' },
        { value: 'high_oxygen', label: 'High oxygen (≥36% or ≥4L nasal)' }
      ]
    },
    {
      id: 'abg_on_prescribed',
      question: 'Was the ABG done while the patient was breathing their prescribed oxygen level?',
      type: 'yesno',
      required: true
    },
    {
      id: 'sleep_apnea_cause',
      question: 'Is sleep apnea the predominant cause of the patient\'s high CO2?',
      type: 'yesno',
      required: true,
      help: 'If sleep apnea is the primary cause, patient may not qualify'
    },
    {
      id: 'current_location',
      question: 'Where is the patient currently?',
      type: 'radio',
      required: true,
      options: [
        { value: 'hospital', label: 'In hospital (being discharged today)' },
        { value: 'home', label: 'At home/outpatient setting' }
      ]
    }
  ];

  const hospitalQuestions = [
    {
      id: 'acute_chronic_rf',
      question: 'Does the patient have acute-on-chronic respiratory failure due to COPD?',
      type: 'yesno',
      required: true
    },
    {
      id: 'hospital_device_use',
      question: 'Did the patient require breathing assistance (ventilator, BiPAP, or similar device) during the 24 hours before discharge?',
      type: 'yesno',
      required: true
    },
    {
      id: 'rapid_deterioration_risk',
      question: 'Is the patient at risk of rapid symptom worsening or CO2 rise after discharge?',
      type: 'yesno',
      required: true
    }
  ];

  const homeQuestions = [
    {
      id: 'chronic_rf',
      question: 'Does the patient have chronic respiratory failure (CRF) due to their COPD?',
      type: 'yesno',
      required: true
    },
    {
      id: 'stability_status',
      question: 'Which describes the patient\'s condition?',
      type: 'radio',
      required: true,
      options: [
        { 
          value: 'stable', 
          label: 'Stable COPD (no worsening cough, sputum, wheezing, or shortness of breath for 2+ weeks AND no respiratory medication changes)' 
        },
        { 
          value: 'post_hospital', 
          label: 'Post-hospital recovery (high CO2 present for 2+ weeks AFTER being discharged from previous hospitalization for COPD exacerbation that required acute NIV)' 
        },
        { 
          value: 'unstable', 
          label: 'Currently unstable or doesn\'t meet either condition above' 
        }
      ]
    }
  ];

  const deviceQuestions = [
    {
      id: 'ventilation_hours',
      question: 'Does the patient need breathing support for more than 8 hours per day?',
      type: 'yesno',
      required: true
    },
    {
      id: 'safety_requirements',
      question: 'Does the patient need alarms and backup battery because stopping breathing support for a few hours could be life-threatening?',
      type: 'yesno',
      required: true,
      help: 'This is for patients who cannot breathe effectively on their own for more than a few hours'
    },
    {
      id: 'current_high_intensity',
      question: 'Is the patient currently using high-intensity settings (≥15 cm H2O pressure AND ≥14 breaths/minute backup rate)?',
      type: 'yesno',
      required: true
    },
    {
      id: 'can_tolerate_high_intensity',
      question: 'Can the patient tolerate high-intensity therapy if not currently using it?',
      type: 'yesno',
      required: true,
      help: 'High-intensity = ≥15 cm H2O pressure with ≥14 breaths/minute backup rate'
    },
    {
      id: 'backup_rate_inappropriate',
      question: 'Is the backup rate feature medically inappropriate for this patient?',
      type: 'yesno',
      required: true,
      help: 'Medical contraindications separate from tolerance (e.g., anxiety, claustrophobia, cardiac conditions)'
    },
    {
      id: 'rad_clinical_outcomes',
      question: 'Based on the patient\'s condition, would a basic RAD device likely fail to achieve clinical goals?',
      type: 'yesno',
      required: true,
      help: 'Clinical goals: normalize CO2 to <46 mmHg, OR stabilize rising CO2, OR reduce CO2 by 20%, OR improve symptoms (headache, fatigue, shortness of breath, confusion, sleep quality)'
    }
  ];

  const getQuestionFlow = () => {
    let flow = [...universalQuestions];
    
    if (answers.current_location === 'hospital') {
      flow = [...flow, ...hospitalQuestions, ...deviceQuestions];
    } else if (answers.current_location === 'home') {
      flow = [...flow, ...homeQuestions, ...deviceQuestions];
    } else {
      return universalQuestions;
    }
    
    return flow;
  };

  const getQuestionById = (id) => {
    const allQuestions = [...universalQuestions, ...hospitalQuestions, ...homeQuestions, ...deviceQuestions];
    return allQuestions.find(q => q.id === id);
  };

  const jumpToQuestion = (questionId) => {
    const questionFlow = getQuestionFlow();
    const questionIndex = questionFlow.findIndex(q => q.id === questionId);
    if (questionIndex !== -1) {
      setCurrentStep(questionIndex);
      setResult(null);
      setEditMode(false);
    }
  };

  const getAnswerStatus = (questionId, value) => {
    switch (questionId) {
      case 'copd_diagnosis':
      case 'abg_done':
      case 'patient_awake':
      case 'abg_on_prescribed':
      case 'chronic_rf':
      case 'acute_chronic_rf':
      case 'hospital_device_use':
      case 'rapid_deterioration_risk':
      case 'ventilation_hours':
      case 'safety_requirements':
      case 'current_high_intensity':
      case 'can_tolerate_high_intensity':
      case 'rad_clinical_outcomes':
        return value === 'yes' ? 'good' : 'bad';
      
      case 'sleep_apnea_cause':
      case 'backup_rate_inappropriate':
        return value === 'no' ? 'good' : 'bad';
      
      case 'co2_value':
        return parseFloat(value) >= 52 ? 'good' : 'bad';
      
      case 'oxygen_requirement':
        return value ? 'good' : 'neutral';
      
      case 'current_location':
        return value ? 'good' : 'neutral';
      
      case 'stability_status':
        return ['stable', 'post_hospital'].includes(value) ? 'good' : 'bad';
      
      default:
        return 'neutral';
    }
  };

  const getAnswerDisplay = (questionId, value) => {
    const question = getQuestionById(questionId);
    if (!question) return value;
    
    if (question.type === 'yesno') {
      return value === 'yes' ? '✓ Yes' : '✗ No';
    } else if (question.type === 'radio') {
      const option = question.options?.find(opt => opt.value === value);
      return option ? option.label : value;
    } else if (question.type === 'number' && question.unit) {
      return `${value} ${question.unit}`;
    }
    return value;
  };

  const calculateAllQualifications = () => {
    const location = answers.current_location;
    const currentlyUsingHighIntensity = answers.current_high_intensity === 'yes';
    const canTolerateHighIntensity = answers.can_tolerate_high_intensity === 'yes';
    const backupRateInappropriate = answers.backup_rate_inappropriate === 'yes';
    
    const highIntensityQualified = currentlyUsingHighIntensity || canTolerateHighIntensity;
    const needsWarning = !currentlyUsingHighIntensity && canTolerateHighIntensity;

    const baseRequirements = [
      { key: 'copd_diagnosis', label: 'COPD diagnosis', met: answers.copd_diagnosis === 'yes' },
      { key: 'abg_done', label: 'ABG test completed', met: answers.abg_done === 'yes' },
      { key: 'co2_value', label: 'High CO2 (≥52 mmHg)', met: parseFloat(answers.co2_value) >= 52 },
      { key: 'patient_awake', label: 'Patient awake during ABG', met: answers.patient_awake === 'yes' },
      { key: 'abg_on_prescribed', label: 'ABG done on prescribed oxygen', met: answers.abg_on_prescribed === 'yes' },
      { key: 'sleep_apnea_cause', label: 'Sleep apnea not primary cause', met: answers.sleep_apnea_cause === 'no' }
    ];

    let qualifications = {};

    if (location === 'home') {
      const homeBaseRequirements = [
        ...baseRequirements,
        { key: 'chronic_rf', label: 'Chronic respiratory failure due to COPD', met: answers.chronic_rf === 'yes' },
        { key: 'stability_status', label: 'Stable condition or post-hospital recovery', met: ['stable', 'post_hospital'].includes(answers.stability_status) }
      ];

      qualifications['RAD with Backup Rate (Home)'] = {
        qualified: false,
        missing: [],
        warning: null,
        requirements: [
          ...homeBaseRequirements,
          { key: 'high_intensity', label: 'Can use high-intensity therapy', met: highIntensityQualified },
          { key: 'backup_appropriate', label: 'Backup rate feature medically appropriate', met: !backupRateInappropriate }
        ]
      };

      qualifications['RAD without Backup Rate (Home)'] = {
        qualified: false,
        missing: [],
        warning: null,
        requirements: [
          ...homeBaseRequirements,
          { key: 'high_intensity_intolerance', label: 'Cannot tolerate high-intensity OR backup rate inappropriate', met: !highIntensityQualified || backupRateInappropriate }
        ]
      };

      qualifications['Home Mechanical Ventilator (Home)'] = {
        qualified: false,
        missing: [],
        warning: null,
        requirements: [
          ...homeBaseRequirements,
          { key: 'hmv_criteria', label: 'At least one HMV criteria met', met: 
            answers.oxygen_requirement === 'high_oxygen' || 
            answers.ventilation_hours === 'yes' || 
            answers.safety_requirements === 'yes' || 
            answers.rad_clinical_outcomes === 'yes' 
          }
        ]
      };

    } else if (location === 'hospital') {
      const hospitalBaseRequirements = [
        ...baseRequirements,
        { key: 'acute_chronic_rf', label: 'Acute-on-chronic respiratory failure', met: answers.acute_chronic_rf === 'yes' },
        { key: 'hospital_device_use', label: 'Used ventilator/RAD in last 24 hours', met: answers.hospital_device_use === 'yes' },
        { key: 'rapid_deterioration_risk', label: 'At risk of rapid deterioration', met: answers.rapid_deterioration_risk === 'yes' }
      ];

      qualifications['RAD with Backup Rate (Hospital Discharge)'] = {
        qualified: false,
        missing: [],
        warning: null,
        requirements: [
          ...hospitalBaseRequirements,
          { key: 'high_intensity', label: 'Can use high-intensity therapy', met: highIntensityQualified },
          { key: 'backup_appropriate', label: 'Backup rate feature medically appropriate', met: !backupRateInappropriate }
        ]
      };

      qualifications['RAD without Backup Rate (Hospital Discharge)'] = {
        qualified: false,
        missing: [],
        warning: null,
        requirements: [
          ...hospitalBaseRequirements,
          { key: 'high_intensity_intolerance', label: 'Cannot tolerate high-intensity OR backup rate inappropriate', met: !highIntensityQualified || backupRateInappropriate }
        ]
      };

      qualifications['Home Mechanical Ventilator (Hospital Discharge)'] = {
        qualified: false,
        missing: [],
        warning: null,
        requirements: [
          ...hospitalBaseRequirements,
          { key: 'hmv_criteria', label: 'At least one HMV criteria met', met: 
            answers.oxygen_requirement === 'high_oxygen' || 
            answers.ventilation_hours === 'yes' || 
            answers.safety_requirements === 'yes' || 
            answers.rad_clinical_outcomes === 'yes' 
          }
        ]
      };
    }

    Object.keys(qualifications).forEach(key => {
      const qual = qualifications[key];
      const metRequirements = qual.requirements.filter(req => req.met);
      const unmetRequirements = qual.requirements.filter(req => !req.met);
      
      qual.qualified = unmetRequirements.length === 0;
      qual.missing = unmetRequirements.map(req => req.label);
      qual.metCount = metRequirements.length;
      qual.totalCount = qual.requirements.length;

      if (key.includes('RAD with Backup Rate') && qual.qualified && needsWarning) {
        qual.warning = '⚠️ WARNING: Patient qualifies but is not currently on required settings. Patient MUST achieve ≥15 cm H2O pressure AND ≥14 breaths/minute backup rate by month 6, or device will be at risk for Medicare pickup.';
      }
    });

    return qualifications;
  };

  const nextStep = () => {
    const questionFlow = getQuestionFlow();
    if (currentStep < questionFlow.length - 1) {
      setCurrentStep(currentStep + 1);
    } else {
      setResult(calculateAllQualifications());
    }
  };

  const prevStep = () => {
    if (currentStep > 0) {
      setCurrentStep(currentStep - 1);
    }
  };

  const restart = () => {
    setCurrentStep(0);
    setAnswers({});
    setResult(null);
    setEditMode(false);
  };

  const handleAnswer = (questionId, value) => {
    setAnswers({ ...answers, [questionId]: value });
  };

  const questionFlow = getQuestionFlow();
  const currentQuestion = questionFlow[currentStep];

  if (result) {
    if (editMode) {
      return (
        <div className="max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg">
          <div className="space-y-4">
            <div className="text-center mb-6">
              <h3 className="text-lg font-semibold mb-2">Edit Assessment Answers</h3>
              <p className="text-gray-600 text-sm">Click any answer to jump to that question and make changes</p>
            </div>
            
            <div className="space-y-3">
              {questionFlow.map((question, index) => {
                const answer = answers[question.id];
                if (!answer) return null;
                
                const answerStatus = getAnswerStatus(question.id, answer);
                const statusColors = {
                  good: 'text-green-600 bg-green-50 border-green-200',
                  bad: 'text-red-600 bg-red-50 border-red-200',
                  neutral: 'text-blue-600 bg-blue-50 border-blue-200'
                };
                
                return (
                  <div key={question.id} className="border rounded-lg p-3 hover:bg-gray-50 transition-colors">
                    <div className="flex items-start justify-between">
                      <div className="flex-1">
                        <h4 className="font-medium text-sm text-gray-800 mb-1">
                          {index + 1}. {question.question}
                        </h4>
                        <div className={`inline-block px-2 py-1 rounded text-sm font-medium border ${statusColors[answerStatus]}`}>
                          {getAnswerDisplay(question.id, answer)}
                        </div>
                      </div>
                      <button
                        onClick={() => jumpToQuestion(question.id)}
                        className="ml-3 px-3 py-1 bg-blue-100 text-blue-700 text-xs rounded hover:bg-blue-200 transition-colors"
                      >
                        Edit
                      </button>
                    </div>
                  </div>
                );
              })}
            </div>
            
            <div className="flex justify-center space-x-4 pt-4 border-t">
              <button
                onClick={() => setEditMode(false)}
                className="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors"
              >
                Back to Results
              </button>
              <button
                onClick={restart}
                className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
              >
                Start New Assessment
              </button>
            </div>
          </div>
        </div>
      );
    }

    return (
      <div className="max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg">
        <div className="text-center mb-6">
          <h2 className="text-2xl font-bold mb-4">
            Qualification Results - {answers.current_location === 'hospital' ? 'Hospital Discharge' : 'Home/Outpatient'}
          </h2>
          
          <div className="flex justify-center space-x-4 mb-4">
            <button
              onClick={() => setViewMode('dashboard')}
              className={`px-4 py-2 rounded ${
                viewMode === 'dashboard' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700'
              }`}
            >
              Dashboard View
            </button>
            <button
              onClick={() => setViewMode('detailed')}
              className={`px-4 py-2 rounded ${
                viewMode === 'detailed' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700'
              }`}
            >
              Detailed View
            </button>
          </div>
        </div>

        {viewMode === 'dashboard' ? (
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
            {Object.entries(result).map(([name, qual]) => (
              <div key={name} className={`p-4 rounded-lg border-2 ${
                qual.qualified ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50'
              }`}>
                <div className="flex items-center justify-between mb-2">
                  <h3 className="font-semibold text-sm">{name}</h3>
                  <div className="flex items-center space-x-1">
                    {qual.warning && <AlertTriangle className="w-4 h-4 text-yellow-600" />}
                    {qual.qualified ? (
                      <CheckCircle className="w-5 h-5 text-green-600" />
                    ) : (
                      <XCircle className="w-5 h-5 text-red-600" />
                    )}
                  </div>
                </div>
                <div className="text-xs text-gray-600 mb-2">
                  {qual.metCount}/{qual.totalCount} requirements met
                </div>
                <div className={`text-sm font-medium ${
                  qual.qualified ? 'text-green-700' : 'text-red-700'
                }`}>
                  {qual.qualified ? 'QUALIFIED' : 'NOT QUALIFIED'}
                </div>
                {!qual.qualified && qual.missing.length > 0 && (
                  <div className="mt-2 text-xs text-red-600">
                    Missing: {qual.missing.slice(0, 2).join(', ')}
                    {qual.missing.length > 2 && '...'}
                  </div>
                )}
              </div>
            ))}
          </div>
        ) : (
          <div className="space-y-6">
            {Object.entries(result).map(([name, qual]) => (
              <div key={name} className="border rounded-lg p-4">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-lg font-semibold">{name}</h3>
                  <div className="flex items-center space-x-2">
                    {qual.warning && <AlertTriangle className="w-5 h-5 text-yellow-600" />}
                    {qual.qualified ? (
                      <>
                        <CheckCircle className="w-6 h-6 text-green-600" />
                        <span className="text-green-700 font-medium">QUALIFIED</span>
                      </>
                    ) : (
                      <>
                        <XCircle className="w-6 h-6 text-red-600" />
                        <span className="text-red-700 font-medium">NOT QUALIFIED</span>
                      </>
                    )}
                  </div>
                </div>

                {qual.warning && (
                  <div className="mb-4 p-3 bg-yellow-50 rounded border border-yellow-200">
                    <div className="flex items-start">
                      <AlertTriangle className="w-5 h-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0" />
                      <p className="text-sm text-yellow-800">{qual.warning}</p>
                    </div>
                  </div>
                )}
                
                <div className="space-y-2">
                  <h4 className="font-medium text-sm text-gray-700">Requirements:</h4>
                  {qual.requirements.map((req, index) => (
                    <div key={index} className="flex items-center space-x-2 text-sm">
                      {req.met ? (
                        <CheckCircle className="w-4 h-4 text-green-500" />
                      ) : (
                        <XCircle className="w-4 h-4 text-red-500" />
                      )}
                      <span className={req.met ? 'text-green-700' : 'text-red-700'}>
                        {req.label}
                      </span>
                    </div>
                  ))}
                </div>

                {!qual.qualified && (
                  <div className="mt-3 p-3 bg-red-50 rounded border border-red-200">
                    <h5 className="font-medium text-red-800 text-sm mb-1">Missing Requirements:</h5>
                    <ul className="text-sm text-red-700 space-y-1">
                      {qual.missing.map((missing, index) => (
                        <li key={index}>• {missing}</li>
                      ))}
                    </ul>
                  </div>
                )}
              </div>
            ))}
          </div>
        )}

        <div className="flex justify-center space-x-4">
          <button
            onClick={() => setEditMode(true)}
            className="bg-green-600 text-white py-3 px-6 rounded-lg hover:bg-green-700 transition-colors"
          >
            Edit Answers
          </button>
          <button
            onClick={restart}
            className="bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors"
          >
            Start New Assessment
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg">
      <div className="mb-6">
        <div className="flex items-center justify-between mb-4">
          <h1 className="text-2xl font-bold">Patient Assessment Tool</h1>
          <span className="text-sm text-gray-500">
            Step {currentStep + 1} of {questionFlow.length}
          </span>
        </div>
        
        <div className="w-full bg-gray-200 rounded-full h-2">
          <div
            className="bg-blue-600 h-2 rounded-full transition-all duration-300"
            style={{ width: `${((currentStep + 1) / questionFlow.length) * 100}%` }}
          ></div>
        </div>
      </div>

      {answers.current_location && (
        <div className="mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200">
          <div className="flex items-center">
            <MapPin className="w-4 h-4 text-blue-600 mr-2" />
            <span className="text-sm text-blue-800">
              Current pathway: {answers.current_location === 'hospital' ? 'Hospital Discharge' : 'Home/Outpatient'}
            </span>
          </div>
        </div>
      )}

      <div className="mb-8">
        <div className="flex items-start mb-4">
          <AlertCircle className="w-5 h-5 text-blue-500 mt-1 mr-3 flex-shrink-0" />
          <div>
            <h2 className="text-lg font-semibold mb-2">
              {currentQuestion.question}
            </h2>
            {currentQuestion.help && (
              <p className="text-sm text-gray-600 italic">
                {currentQuestion.help}
              </p>
            )}
          </div>
        </div>

        <div className="space-y-3">
          {currentQuestion.type === 'yesno' && (
            <div className="space-y-2">
              <button
                onClick={() => handleAnswer(currentQuestion.id, 'yes')}
                className={`w-full p-4 text-left rounded-lg border-2 transition-all ${
                  answers[currentQuestion.id] === 'yes'
                    ? 'border-green-500 bg-green-50'
                    : 'border-gray-200 hover:border-green-300'
                }`}
              >
                ✓ Yes
              </button>
              <button
                onClick={() => handleAnswer(currentQuestion.id, 'no')}
                className={`w-full p-4 text-left rounded-lg border-2 transition-all ${
                  answers[currentQuestion.id] === 'no'
                    ? 'border-red-500 bg-red-50'
                    : 'border-gray-200 hover:border-red-300'
                }`}
              >
                ✗ No
              </button>
            </div>
          )}

          {currentQuestion.type === 'number' && (
            <div className="space-y-2">
              <div className="flex items-center space-x-2">
                <input
                  type="number"
                  placeholder="Enter CO2 value"
                  value={answers[currentQuestion.id] || ''}
                  onChange={(e) => handleAnswer(currentQuestion.id, e.target.value)}
                  className="flex-1 p-4 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"
                />
                {currentQuestion.unit && (
                  <span className="text-gray-600 font-medium">{currentQuestion.unit}</span>
                )}
              </div>
              {answers[currentQuestion.id] && (
                <div className={`p-2 rounded text-sm ${
                  parseFloat(answers[currentQuestion.id]) >= 52 
                    ? 'bg-green-50 text-green-700 border border-green-200' 
                    : 'bg-red-50 text-red-700 border border-red-200'
                }`}>
                  {parseFloat(answers[currentQuestion.id]) >= 52 
                    ? '✓ Meets requirement (≥52 mmHg)' 
                    : '✗ Does not meet requirement (≥52 mmHg)'}
                </div>
              )}
            </div>
          )}

          {currentQuestion.type === 'radio' && (
            <div className="space-y-2">
              {currentQuestion.options.map((option) => (
                <button
                  key={option.value}
                  onClick={() => handleAnswer(currentQuestion.id, option.value)}
                  className={`w-full p-4 text-left rounded-lg border-2 transition-all ${
                    answers[currentQuestion.id] === option.value
                      ? 'border-blue-500 bg-blue-50'
                      : 'border-gray-200 hover:border-blue-300'
                  }`}
                >
                  {option.label}
                </button>
              ))}
            </div>
          )}
        </div>
      </div>

      <div className="flex justify-between">
        <button
          onClick={prevStep}
          disabled={currentStep === 0}
          className="flex items-center px-4 py-2 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          <ChevronLeft className="w-4 h-4 mr-1" />
          Previous
        </button>

        <button
          onClick={nextStep}
          disabled={!answers[currentQuestion?.id]}
          className="flex items-center px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
        >
          {currentStep === questionFlow.length - 1 ? 'Get Results' : 'Next'}
          <ChevronRight className="w-4 h-4 ml-1" />
        </button>
      </div>
    </div>
  );
};

export default WorkflowTool;